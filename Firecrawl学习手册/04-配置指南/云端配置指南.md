# ğŸš€ Firecrawl äº‘ API å¿«é€Ÿé…ç½®æŒ‡å—

> **ä¸“ä¸º HawaiiHub å›¢é˜Ÿæ‰“é€ **
> **é…ç½®æ—¶é—´**: 10 åˆ†é’Ÿ
> **éš¾åº¦**: â­â­â˜†â˜†â˜†

---

## ğŸ“‹ æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” | é€‚åˆäººç¾¤ |
|------|------|---------|
| **FIRECRAWL_CLOUD_API_RULES.md** | å®Œæ•´ä½¿ç”¨è§„èŒƒï¼ˆæœ¬è§„èŒƒï¼‰ | æ‰€æœ‰å¼€å‘è€… â­â­â­â­â­ |
| FIRECRAWL_README.md | é¡¹ç›®å…¥å£ | æ–°æ‰‹ |
| FIRECRAWL_QUICK_INDEX.md | å¿«é€Ÿç´¢å¼• | æŸ¥æ‰¾é¡¹ç›® |
| FIRECRAWL_ECOSYSTEM_GUIDE.md | ç”Ÿæ€ç³»ç»Ÿ | æ·±å…¥å­¦ä¹  |

---

## âš¡ 5 åˆ†é’Ÿå¿«é€Ÿé…ç½®

### æ­¥éª¤ 1: ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®
vim .env
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```bash
# ========================================
# Firecrawl äº‘ API é…ç½®
# ========================================

# ğŸ”‘ å¿…éœ€ï¼šAPI å¯†é’¥
FIRECRAWL_API_KEY=fc-your-api-key-here

# ğŸŒ API ç«¯ç‚¹ï¼ˆé€šå¸¸ä¸éœ€è¦ä¿®æ”¹ï¼‰
FIRECRAWL_API_URL=https://api.firecrawl.dev

# â±ï¸ è¶…æ—¶è®¾ç½®ï¼ˆç§’ï¼‰
FIRECRAWL_TIMEOUT=60

# ğŸ”„ é‡è¯•æ¬¡æ•°
FIRECRAWL_MAX_RETRIES=3

# ğŸ’¾ ç¼“å­˜é…ç½®
FIRECRAWL_ENABLE_CACHE=true
FIRECRAWL_CACHE_TTL=3600

# ğŸ’° æˆæœ¬é™åˆ¶
FIRECRAWL_DAILY_BUDGET=10.0
FIRECRAWL_MONTHLY_BUDGET=200.0

# ğŸš¨ å‘Šè­¦ï¼ˆå¯é€‰ï¼‰
FIRECRAWL_ALERT_WEBHOOK=https://hooks.slack.com/your-webhook

# ğŸ”’ å¤‡ç”¨å¯†é’¥ï¼ˆå¯é€‰ï¼‰
FIRECRAWL_API_KEY_BACKUP_1=fc-backup-key-1
FIRECRAWL_API_KEY_BACKUP_2=fc-backup-key-2
```

### æ­¥éª¤ 2: å®‰è£…ä¾èµ–

```bash
pip install firecrawl-py python-dotenv requests
```

### æ­¥éª¤ 3: æµ‹è¯•è¿æ¥

åˆ›å»º `test_firecrawl.py`:

```python
import os
from dotenv import load_dotenv
from firecrawl import FirecrawlApp

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

# åˆå§‹åŒ–å®¢æˆ·ç«¯
app = FirecrawlApp(api_key=os.getenv('FIRECRAWL_API_KEY'))

# æµ‹è¯•çˆ¬å–
result = app.scrape(
    url="https://www.hawaiinewsnow.com/",
    formats=['markdown'],
    onlyMainContent=True
)

print("âœ… è¿æ¥æˆåŠŸï¼")
print(f"æ ‡é¢˜: {result.get('title', 'N/A')}")
print(f"å†…å®¹é•¿åº¦: {len(result.get('markdown', ''))} å­—ç¬¦")
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
python test_firecrawl.py
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½é€Ÿè§ˆ

### 1. åŸºç¡€çˆ¬å–

```python
from firecrawl import FirecrawlApp
import os

app = FirecrawlApp(api_key=os.getenv('FIRECRAWL_API_KEY'))

# å•é¡µçˆ¬å–
result = app.scrape(
    url="https://example.com",
    formats=['markdown'],
    onlyMainContent=True,      # âœ… åªè¦ä¸»è¦å†…å®¹
    maxAge=3600000             # âœ… ä½¿ç”¨ 1 å°æ—¶ç¼“å­˜
)

# æ‰¹é‡çˆ¬å–
results = app.batch_scrape(
    urls=["https://example.com/1", "https://example.com/2"],
    formats=['markdown']
)
```

### 2. æœç´¢åŠŸèƒ½

```python
# æœç´¢å¤å¨å¤·æ–°é—»
results = app.search(
    query="Hawaii news å¤å¨å¤· åäººç¤¾åŒº",
    sources=[{"type": "web"}],
    limit=10
)
```

### 3. å˜æ›´ç›‘æ§

```python
# ç›‘æ§ç½‘ç«™å˜åŒ–
result = app.scrape(
    url="https://example.com",
    formats=['markdown', {'type': 'changeTracking'}]
)
```

---

## ğŸ’¡ æœ€ä½³å®è·µï¼ˆå¿…è¯»ï¼‰

### âœ… DO - æ¨èåšæ³•

#### 1. ä½¿ç”¨æ‰¹é‡æ¥å£
```python
# âœ… å¥½ - æ‰¹é‡å¤„ç†
results = app.batch_scrape(urls)

# âŒ å·® - å¾ªç¯è°ƒç”¨
for url in urls:
    result = app.scrape(url)
```

#### 2. å¯ç”¨ç¼“å­˜
```python
# âœ… å¥½ - ä½¿ç”¨ç¼“å­˜
result = app.scrape(url, maxAge=3600000)

# âŒ å·® - ä¸ä½¿ç”¨ç¼“å­˜
result = app.scrape(url)
```

#### 3. è¿‡æ»¤å†…å®¹
```python
# âœ… å¥½ - åªè¦ä¸»è¦å†…å®¹
result = app.scrape(
    url,
    onlyMainContent=True,
    removeTags=['script', 'style']
)

# âŒ å·® - è·å–æ‰€æœ‰å†…å®¹ï¼ˆæµªè´¹ï¼‰
result = app.scrape(url)
```

#### 4. é”™è¯¯å¤„ç†
```python
# âœ… å¥½ - å®Œæ•´çš„é”™è¯¯å¤„ç†
try:
    result = app.scrape(url)
except Exception as e:
    logger.error(f"çˆ¬å–å¤±è´¥: {url} - {e}")
    # é™çº§å¤„ç†
    result = fallback_scrape(url)

# âŒ å·® - ä¸å¤„ç†é”™è¯¯
result = app.scrape(url)
```

#### 5. æˆæœ¬ç›‘æ§
```python
# âœ… å¥½ - è¿½è¸ªæˆæœ¬
@track_cost('scrape')
def scrape_urls(urls):
    return app.batch_scrape(urls)

# å®šæœŸæ£€æŸ¥
print(f"ä»Šæ—¥æˆæœ¬: ${cost_tracker.get_cost()}")
```

---

### âŒ DON'T - ç¦æ­¢è¡Œä¸º

#### 1. ç¡¬ç¼–ç å¯†é’¥
```python
# âŒ ä¸¥ç¦
app = FirecrawlApp(api_key="fc-xxxxxxxx")

# âœ… æ­£ç¡®
app = FirecrawlApp(api_key=os.getenv('FIRECRAWL_API_KEY'))
```

#### 2. ä¸éªŒè¯ URL
```python
# âŒ å±é™©
result = app.scrape(user_input_url)

# âœ… å®‰å…¨
if URLValidator.validate(user_input_url):
    result = app.scrape(user_input_url)
```

#### 3. å¿½ç•¥é€Ÿç‡é™åˆ¶
```python
# âŒ ä¼šè¢«é™æµ
for url in urls:
    app.scrape(url)

# âœ… é€Ÿç‡æ§åˆ¶
rate_limiter.wait_if_needed()
app.scrape(url)
```

#### 4. ä¸æ§åˆ¶æˆæœ¬
```python
# âŒ å¯èƒ½è¶…æ”¯
app.crawl(url, limit=1000)

# âœ… æ§åˆ¶é¢„ç®—
if budget.check_budget(estimated_cost):
    app.crawl(url, limit=100)
```

---

## ğŸ“Š æˆæœ¬é¢„ç®—å‚è€ƒ

### å®šä»·ï¼ˆå®é™…ä»¥å®˜æ–¹ä¸ºå‡†ï¼‰

| æ“ä½œ | å•ä»· | è¯´æ˜ |
|------|------|------|
| Scrape | ~$0.005/é¡µ | å•é¡µçˆ¬å– |
| Crawl | ~$0.004/é¡µ | æ‰¹é‡çˆ¬å–ï¼ˆæœ‰æŠ˜æ‰£ï¼‰ |
| Search | ~$0.01/æ¬¡ | æœç´¢åŠŸèƒ½ |
| Extract | ~$0.008/æ¬¡ | ç»“æ„åŒ–æå– |

### HawaiiHub é¢„ç®—å»ºè®®

| é˜¶æ®µ | æ¯æ—¥é¢„ç®— | æ¯æœˆé¢„ç®— | é¢„ä¼°ç”¨é‡ |
|------|---------|---------|---------|
| MVP | $10 | $200 | 2K é¡µ/å¤© |
| å¢é•¿æœŸ | $20 | $500 | 5K é¡µ/å¤© |
| æˆç†ŸæœŸ | $50 | $1000 | 12K é¡µ/å¤© |

### çœé’±æŠ€å·§

1. **å……åˆ†åˆ©ç”¨ç¼“å­˜**ï¼šç›¸åŒå†…å®¹ 1 å°æ—¶å†…ä¸é‡å¤çˆ¬å–
2. **æ‰¹é‡å¤„ç†**ï¼šä½¿ç”¨ `batch_scrape` è·å¾—æŠ˜æ‰£
3. **è¿‡æ»¤å†…å®¹**ï¼šåªçˆ¬å–éœ€è¦çš„éƒ¨åˆ†
4. **å®šæ—¶ä»»åŠ¡**ï¼šé”™å³°æ‰§è¡Œï¼ˆå¤œé—´ï¼‰
5. **å»é‡**ï¼šé¿å…é‡å¤çˆ¬å–ç›¸åŒ URL

---

## ğŸš¨ å…³é”®é…ç½®

### 1. æˆæœ¬å‘Šè­¦

```python
# config/alerts.py
from firecrawl_utils import cost_tracker, alert_system

def check_daily_budget():
    """æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡é¢„ç®—"""
    cost = cost_tracker.get_cost()

    if cost > 8.0:  # 80% é¢„ç®—
        alert_system.alert(
            level=AlertLevel.WARNING,
            title="æˆæœ¬å‘Šè­¦",
            message=f"ä»Šæ—¥æˆæœ¬ ${cost:.2f}ï¼Œæ¥è¿‘é¢„ç®—ä¸Šé™"
        )
```

### 2. è‡ªåŠ¨é‡è¯•

```python
# config/retry.py
from firecrawl_utils import retry_with_exponential_backoff

@retry_with_exponential_backoff(max_retries=5)
def scrape_with_retry(url):
    return app.scrape(url)
```

### 3. é€Ÿç‡é™åˆ¶

```python
# config/rate_limit.py
from firecrawl_utils import RateLimiter

rate_limiter = RateLimiter(
    max_requests=100,  # æ¯åˆ†é’Ÿ 100 æ¬¡
    time_window=60
)

def rate_limited_scrape(url):
    rate_limiter.wait_if_needed()
    return app.scrape(url)
```

---

## ğŸ“ˆ ç›‘æ§ä»ªè¡¨æ¿

### å®æ—¶æŒ‡æ ‡

```python
# æ‰“å°å®æ—¶æŒ‡æ ‡
from firecrawl_utils import dashboard

dashboard.print_dashboard()
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
================================================================================
ğŸ“Š Firecrawl API å®æ—¶ç›‘æ§ä»ªè¡¨æ¿
================================================================================

SCRAPE:
  æ€»è¯·æ±‚: 150
  æˆåŠŸ: 145
  å¤±è´¥: 5
  æˆåŠŸç‡: 96.7%
  å¹³å‡è€—æ—¶: 1.85s

SEARCH:
  æ€»è¯·æ±‚: 20
  æˆåŠŸ: 20
  å¤±è´¥: 0
  æˆåŠŸç‡: 100.0%
  å¹³å‡è€—æ—¶: 3.12s

æ¯å°æ—¶è¯·æ±‚è¶‹åŠ¿:
  2025-10-27 08:00: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (80)
  2025-10-27 09:00: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (60)
  2025-10-27 10:00: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (100)
================================================================================
```

---

## ğŸ› ï¸ å¸¸ç”¨ä»£ç ç‰‡æ®µ

### æ–°é—»é‡‡é›†

```python
# scripts/scrape_news.py
from firecrawl_utils import firecrawl_client

def scrape_hawaii_news():
    """çˆ¬å–å¤å¨å¤·æ–°é—»"""
    news_sites = [
        "https://www.hawaiinewsnow.com/",
        "https://www.staradvertiser.com/",
        "https://www.civilbeat.org/"
    ]

    results = firecrawl_client.batch_scrape(
        urls=news_sites,
        formats=['markdown'],
        onlyMainContent=True
    )

    # ä¿å­˜ç»“æœ
    for result in results:
        save_to_database(result)

    # æ‰“å°æŒ‡æ ‡
    metrics = firecrawl_client.get_metrics()
    print(f"âœ… çˆ¬å–å®Œæˆï¼æˆæœ¬: ${metrics['cost']['total_cost']}")

    return results

if __name__ == "__main__":
    scrape_hawaii_news()
```

### å®šæ—¶ä»»åŠ¡

```bash
# crontab é…ç½®
# æ¯å°æ—¶çˆ¬å–ä¸€æ¬¡æ–°é—»
0 * * * * cd /path/to/project && python scripts/scrape_news.py

# æ¯æ—¥æˆæœ¬æŠ¥å‘Šï¼ˆæ—©ä¸Š 9 ç‚¹ï¼‰
0 9 * * * cd /path/to/project && python scripts/daily_report.py

# æ¯å‘¨æ¸…ç†ç¼“å­˜ï¼ˆå‘¨æ—¥å‡Œæ™¨ 2 ç‚¹ï¼‰
0 2 * * 0 cd /path/to/project && python scripts/clear_cache.py
```

---

## ğŸ“š å®Œæ•´ä»£ç ç¤ºä¾‹

### HawaiiHub æ–°é—»çˆ¬è™«

```python
# hawaiihub/news_scraper.py
import os
from typing import List, Dict
from dotenv import load_dotenv
from firecrawl import FirecrawlApp

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

class HawaiiNewsScraper:
    """å¤å¨å¤·æ–°é—»çˆ¬è™«"""

    # æ–°é—»æºé…ç½®
    NEWS_SOURCES = {
        'hawaii_news_now': 'https://www.hawaiinewsnow.com/',
        'star_advertiser': 'https://www.staradvertiser.com/',
        'civil_beat': 'https://www.civilbeat.org/',
    }

    def __init__(self):
        self.app = FirecrawlApp(api_key=os.getenv('FIRECRAWL_API_KEY'))

    def scrape_all_news(self) -> List[Dict]:
        """çˆ¬å–æ‰€æœ‰æ–°é—»æº"""
        results = []

        for source_name, url in self.NEWS_SOURCES.items():
            try:
                print(f"ğŸ”„ çˆ¬å– {source_name}...")

                # ä½¿ç”¨ Search å‘ç°æ–°é—»
                search_results = self.app.search(
                    query=f"site:{url} Hawaii news",
                    limit=10
                )

                # æ‰¹é‡çˆ¬å–å®Œæ•´å†…å®¹
                urls = [r['url'] for r in search_results]
                articles = self.app.batch_scrape(
                    urls=urls,
                    formats=['markdown'],
                    onlyMainContent=True
                )

                # æ·»åŠ æ¥æºæ ‡è®°
                for article in articles:
                    article['source'] = source_name

                results.extend(articles)
                print(f"âœ… {source_name}: {len(articles)} ç¯‡æ–‡ç« ")

            except Exception as e:
                print(f"âŒ {source_name} å¤±è´¥: {e}")

        return results

    def save_to_database(self, articles: List[Dict]):
        """ä¿å­˜åˆ°æ•°æ®åº“"""
        # TODO: å®ç°æ•°æ®åº“ä¿å­˜é€»è¾‘
        pass

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    scraper = HawaiiNewsScraper()
    articles = scraper.scrape_all_news()

    print(f"\nğŸ“Š æ€»è®¡çˆ¬å– {len(articles)} ç¯‡æ–‡ç« ")

    # ä¿å­˜åˆ°æ•°æ®åº“
    scraper.save_to_database(articles)
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### Q1: `Authentication failed` é”™è¯¯

**åŸå› **: API å¯†é’¥æ— æ•ˆæˆ–è¿‡æœŸ

**è§£å†³**:
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $FIRECRAWL_API_KEY

# é‡æ–°è®¾ç½®
export FIRECRAWL_API_KEY=fc-your-new-key

# éªŒè¯
python test_firecrawl.py
```

#### Q2: `Rate limit exceeded` é”™è¯¯

**åŸå› **: è¶…è¿‡é€Ÿç‡é™åˆ¶

**è§£å†³**:
```python
# æ·»åŠ é€Ÿç‡é™åˆ¶
from firecrawl_utils import rate_limiter

rate_limiter.wait_if_needed()
result = app.scrape(url)
```

#### Q3: `Request timeout` é”™è¯¯

**åŸå› **: è¯·æ±‚è¶…æ—¶

**è§£å†³**:
```bash
# å¢åŠ è¶…æ—¶æ—¶é—´
export FIRECRAWL_TIMEOUT=120
```

#### Q4: æˆæœ¬è¿‡é«˜

**åŸå› **: æœªä¼˜åŒ–è¯·æ±‚

**è§£å†³**:
1. å¯ç”¨ç¼“å­˜
2. ä½¿ç”¨æ‰¹é‡æ¥å£
3. è¿‡æ»¤ä¸éœ€è¦çš„å†…å®¹
4. å»é‡ URL

---

## âœ… ä¸Šçº¿æ£€æŸ¥æ¸…å•

### é…ç½®æ£€æŸ¥

- [ ] âœ… `.env` æ–‡ä»¶å·²é…ç½®
- [ ] âœ… API å¯†é’¥å·²éªŒè¯
- [ ] âœ… å¤‡ç”¨å¯†é’¥å·²è®¾ç½®
- [ ] âœ… é¢„ç®—é™åˆ¶å·²é…ç½®
- [ ] âœ… å‘Šè­¦ Webhook å·²æµ‹è¯•

### åŠŸèƒ½æ£€æŸ¥

- [ ] âœ… åŸºç¡€çˆ¬å–åŠŸèƒ½æ­£å¸¸
- [ ] âœ… æ‰¹é‡çˆ¬å–åŠŸèƒ½æ­£å¸¸
- [ ] âœ… ç¼“å­˜åŠŸèƒ½å¯ç”¨
- [ ] âœ… é”™è¯¯å¤„ç†å®Œæ•´
- [ ] âœ… æ—¥å¿—è®°å½•æ­£å¸¸

### ç›‘æ§æ£€æŸ¥

- [ ] âœ… æˆæœ¬ç›‘æ§å·²å¯ç”¨
- [ ] âœ… æ€§èƒ½ç›‘æ§å·²å¯ç”¨
- [ ] âœ… å‘Šè­¦ç³»ç»Ÿå·²æµ‹è¯•
- [ ] âœ… ä»ªè¡¨æ¿å¯è®¿é—®

### å®‰å…¨æ£€æŸ¥

- [ ] âœ… API å¯†é’¥å®‰å…¨å­˜å‚¨
- [ ] âœ… URL éªŒè¯å·²å®ç°
- [ ] âœ… æ•°æ®è„±æ•å·²é…ç½®
- [ ] âœ… `.env` å·²åŠ å…¥ `.gitignore`

---

## ğŸ“ è·å–å¸®åŠ©

### å®˜æ–¹èµ„æº

- ğŸ“š [å®˜æ–¹æ–‡æ¡£](https://docs.firecrawl.dev)
- ğŸ’¬ [Discord ç¤¾åŒº](https://discord.gg/firecrawl)
- ğŸ“§ [æŠ€æœ¯æ”¯æŒ](mailto:hello@firecrawl.dev)

### å›¢é˜Ÿèµ„æº

- ğŸ“– **å®Œæ•´è§„èŒƒ**: `FIRECRAWL_CLOUD_API_RULES.md`
- ğŸ” **å¿«é€Ÿç´¢å¼•**: `FIRECRAWL_QUICK_INDEX.md`
- ğŸ“š **ç”Ÿæ€ç³»ç»Ÿ**: `FIRECRAWL_ECOSYSTEM_GUIDE.md`
- ğŸš€ **å›¢é˜Ÿè§„èŒƒ**: `/Users/zhiledeng/Documents/augment-projects/AGENTS.md`

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç«‹å³**: å®Œæˆç¯å¢ƒé…ç½®ï¼ˆ10 åˆ†é’Ÿï¼‰
2. **ä»Šå¤©**: è¿è¡Œç¬¬ä¸€ä¸ªçˆ¬è™«æµ‹è¯•
3. **æœ¬å‘¨**: éƒ¨ç½²æ–°é—»é‡‡é›†ç³»ç»Ÿ
4. **æœ¬æœˆ**: ä¼˜åŒ–æˆæœ¬å’Œæ€§èƒ½

---

**ğŸ”¥ å¼€å§‹ä½¿ç”¨ Firecrawl äº‘ APIï¼Œä¸º HawaiiHub æä¾›å¼ºå¤§çš„æ•°æ®é‡‡é›†èƒ½åŠ›ï¼ğŸŒ´**

---

_åˆ›å»ºæ—¶é—´: 2025-10-27_
_ç»´æŠ¤è€…: HawaiiHub AI Team_
_ç‰ˆæœ¬: v1.0.0_
